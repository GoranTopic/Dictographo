{"ast":null,"code":"import { AmbientLight, DirectionalLight, Vector3 } from 'three';\nimport { DragControls } from 'three/examples/jsm/controls/DragControls.js';\nimport ThreeForceGraph from 'three-forcegraph';\nimport ThreeRenderObjects from 'three-render-objects';\nimport accessorFn from 'accessor-fn';\nimport Kapsule from 'kapsule';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".graph-info-msg {\\n  top: 50%;\\n  width: 100%;\\n  text-align: center;\\n  color: lavender;\\n  opacity: 0.7;\\n  font-size: 22px;\\n  position: absolute;\\n  font-family: Sans-serif;\\n}\\n\\n.grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\";\nstyleInject(css_248z);\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction linkKapsule(kapsulePropName, kapsuleType) {\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          state[kapsulePropName][prop](v);\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        var kapsuleInstance = state[kapsulePropName];\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n        return returnVal === kapsuleInstance ? this // chain based on the parent object, not the inner kapsule\n        : returnVal;\n      };\n    }\n  };\n}\n\nvar three = window.THREE ? window.THREE // Prefer consumption from global THREE, if exists\n: {\n  AmbientLight: AmbientLight,\n  DirectionalLight: DirectionalLight,\n  Vector3: Vector3\n};\nvar CAMERA_DISTANCE2NODES_FACTOR = 170; //\n// Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', ThreeForceGraph);\nvar linkedFGProps = Object.assign.apply(Object, _toConsumableArray(['jsonUrl', 'graphData', 'numDimensions', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'nodeRelSize', 'nodeId', 'nodeVal', 'nodeResolution', 'nodeColor', 'nodeAutoColorBy', 'nodeOpacity', 'nodeVisibility', 'nodeThreeObject', 'nodeThreeObjectExtend', 'linkSource', 'linkTarget', 'linkVisibility', 'linkColor', 'linkAutoColorBy', 'linkOpacity', 'linkWidth', 'linkResolution', 'linkCurvature', 'linkCurveRotation', 'linkMaterial', 'linkThreeObject', 'linkThreeObjectExtend', 'linkPositionUpdate', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalArrowResolution', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleResolution', 'forceEngine', 'd3AlphaDecay', 'd3VelocityDecay', 'd3AlphaMin', 'ngraphPhysics', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})));\nvar linkedFGMethods = Object.assign.apply(Object, _toConsumableArray(['refresh', 'getGraphBbox', 'd3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n}))); // Expose config from renderObjs\n\nvar bindRenderObjs = linkKapsule('renderObjs', ThreeRenderObjects);\nvar linkedRenderObjsProps = Object.assign.apply(Object, _toConsumableArray(['width', 'height', 'backgroundColor', 'showNavInfo', 'enablePointerInteraction'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkProp(p));\n})));\nvar linkedRenderObjsMethods = Object.assign.apply(Object, _toConsumableArray(['cameraPosition', 'postProcessingComposer'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkMethod(p));\n})).concat([{\n  graph2ScreenCoords: bindRenderObjs.linkMethod('getScreenCoords')\n}])); //\n\nvar _3dForceGraph = Kapsule({\n  props: _objectSpread2(_objectSpread2({\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 1,\n      onChange: function onChange(p, state) {\n        return state.renderObjs.lineHoverPrecision(p);\n      },\n      triggerUpdate: false\n    },\n    enableNavigationControls: {\n      \"default\": true,\n      onChange: function onChange(enable, state) {\n        var controls = state.renderObjs.controls();\n\n        if (controls) {\n          controls.enabled = enable;\n        }\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    }\n  }, linkedFGProps), linkedRenderObjsProps),\n  methods: _objectSpread2(_objectSpread2({\n    zoomToFit: function zoomToFit(state, transitionDuration, padding) {\n      var _state$forceGraph;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      state.renderObjs.fitToBbox((_state$forceGraph = state.forceGraph).getGraphBbox.apply(_state$forceGraph, bboxArgs), transitionDuration, padding);\n      return this;\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId !== null) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (state.animationFrameRequestId === null) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _animationCycle: function _animationCycle(state) {\n      if (state.enablePointerInteraction) {\n        // reset canvas cursor (override dragControls cursor)\n        this.renderer().domElement.style.cursor = null;\n      } // Frame cycle\n\n\n      state.forceGraph.tickFrame();\n      state.renderObjs.tick();\n      state.animationFrameRequestId = requestAnimationFrame(this._animationCycle);\n    },\n    scene: function scene(state) {\n      return state.renderObjs.scene();\n    },\n    // Expose scene\n    camera: function camera(state) {\n      return state.renderObjs.camera();\n    },\n    // Expose camera\n    renderer: function renderer(state) {\n      return state.renderObjs.renderer();\n    },\n    // Expose renderer\n    controls: function controls(state) {\n      return state.renderObjs.controls();\n    },\n    // Expose controls\n    tbControls: function tbControls(state) {\n      return state.renderObjs.tbControls();\n    },\n    // To be deprecated\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedFGMethods), linkedRenderObjsMethods),\n  stateInit: function stateInit(_ref5) {\n    var controlType = _ref5.controlType,\n        rendererConfig = _ref5.rendererConfig;\n    return {\n      forceGraph: new ThreeForceGraph(),\n      renderObjs: ThreeRenderObjects({\n        controlType: controlType,\n        rendererConfig: rendererConfig\n      })\n    };\n  },\n  init: function init(domNode, state) {\n    // Wipe DOM\n    domNode.innerHTML = ''; // Add relative container\n\n    domNode.appendChild(state.container = document.createElement('div'));\n    state.container.style.position = 'relative'; // Add renderObjs\n\n    var roDomNode = document.createElement('div');\n    state.container.appendChild(roDomNode);\n    state.renderObjs(roDomNode);\n    var camera = state.renderObjs.camera();\n    var renderer = state.renderObjs.renderer();\n    var controls = state.renderObjs.controls();\n    controls.enabled = !!state.enableNavigationControls;\n    state.lastSetCameraZ = camera.position.z; // Add info space\n\n    var infoElem;\n    state.container.appendChild(infoElem = document.createElement('div'));\n    infoElem.className = 'graph-info-msg';\n    infoElem.textContent = ''; // config forcegraph\n\n    state.forceGraph.onLoading(function () {\n      infoElem.textContent = 'Loading...';\n    }).onFinishLoading(function () {\n      infoElem.textContent = '';\n    }).onUpdate(function () {\n      // sync graph data structures\n      state.graphData = state.forceGraph.graphData(); // re-aim camera, if still in default position (not user modified)\n\n      if (camera.position.x === 0 && camera.position.y === 0 && camera.position.z === state.lastSetCameraZ && state.graphData.nodes.length) {\n        camera.lookAt(state.forceGraph.position);\n        state.lastSetCameraZ = camera.position.z = Math.cbrt(state.graphData.nodes.length) * CAMERA_DISTANCE2NODES_FACTOR;\n      }\n    }).onFinishUpdate(function () {\n      // Setup node drag interaction\n      if (state._dragControls) {\n        var curNodeDrag = state.graphData.nodes.find(function (node) {\n          return node.__initialFixedPos && !node.__disposeControlsAfterDrag;\n        }); // detect if there's a node being dragged using the existing drag controls\n\n        if (curNodeDrag) {\n          curNodeDrag.__disposeControlsAfterDrag = true; // postpone previous controls disposal until drag ends\n        } else {\n          state._dragControls.dispose(); // cancel previous drag controls\n\n        }\n\n        state._dragControls = undefined;\n      }\n\n      if (state.enableNodeDrag && state.enablePointerInteraction && state.forceEngine === 'd3') {\n        // Can't access node positions programatically in ngraph\n        var dragControls = state._dragControls = new DragControls(state.graphData.nodes.map(function (node) {\n          return node.__threeObj;\n        }).filter(function (obj) {\n          return obj;\n        }), camera, renderer.domElement);\n        dragControls.addEventListener('dragstart', function (event) {\n          controls.enabled = false; // Disable controls while dragging\n          // track drag object movement\n\n          event.object.__initialPos = event.object.position.clone();\n          event.object.__prevPos = event.object.position.clone();\n\n          var node = getGraphObj(event.object).__data;\n\n          !node.__initialFixedPos && (node.__initialFixedPos = {\n            fx: node.fx,\n            fy: node.fy,\n            fz: node.fz\n          });\n          !node.__initialPos && (node.__initialPos = {\n            x: node.x,\n            y: node.y,\n            z: node.z\n          }); // lock node\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c];\n          }); // drag cursor\n\n          renderer.domElement.classList.add('grabbable');\n        });\n        dragControls.addEventListener('drag', function (event) {\n          var nodeObj = getGraphObj(event.object);\n\n          if (!event.object.hasOwnProperty('__graphObjType')) {\n            // If dragging a child of the node, update the node object instead\n            var initPos = event.object.__initialPos;\n            var prevPos = event.object.__prevPos;\n            var _newPos = event.object.position;\n            nodeObj.position.add(_newPos.clone().sub(prevPos)); // translate node object by the motion delta\n\n            prevPos.copy(_newPos);\n\n            _newPos.copy(initPos); // reset child back to its initial position\n\n          }\n\n          var node = nodeObj.__data;\n          var newPos = nodeObj.position;\n          var translate = {\n            x: newPos.x - node.x,\n            y: newPos.y - node.y,\n            z: newPos.z - node.z\n          }; // Move fx/fy/fz (and x/y/z) of nodes based on object new position\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c] = newPos[c];\n          });\n          state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n          .resetCountdown(); // prevent freeze while dragging\n\n          node.__dragged = true;\n          state.onNodeDrag(node, translate);\n        });\n        dragControls.addEventListener('dragend', function (event) {\n          delete event.object.__initialPos; // remove tracking attributes\n\n          delete event.object.__prevPos;\n\n          var node = getGraphObj(event.object).__data; // dispose previous controls if needed\n\n\n          if (node.__disposeControlsAfterDrag) {\n            dragControls.dispose();\n            delete node.__disposeControlsAfterDrag;\n          }\n\n          var initFixedPos = node.__initialFixedPos;\n          var initPos = node.__initialPos;\n          var translate = {\n            x: initPos.x - node.x,\n            y: initPos.y - node.y,\n            z: initPos.z - node.z\n          };\n\n          if (initFixedPos) {\n            ['x', 'y', 'z'].forEach(function (c) {\n              var fc = \"f\".concat(c);\n\n              if (initFixedPos[fc] === undefined) {\n                delete node[fc];\n              }\n            });\n            delete node.__initialFixedPos;\n            delete node.__initialPos;\n\n            if (node.__dragged) {\n              delete node.__dragged;\n              state.onNodeDragEnd(node, translate);\n            }\n          }\n\n          state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n          .resetCountdown(); // let the engine readjust after releasing fixed nodes\n\n          if (state.enableNavigationControls) {\n            controls.enabled = true; // Re-enable controls\n\n            controls.domElement && controls.domElement.ownerDocument && controls.domElement.ownerDocument.dispatchEvent( // simulate mouseup to ensure the controls don't take over after dragend\n            new PointerEvent('pointerup', {\n              pointerType: 'mouse'\n            }));\n          } // clear cursor\n\n\n          renderer.domElement.classList.remove('grabbable');\n        });\n      }\n    }); // config renderObjs\n\n    state.renderObjs.objects([// Populate scene\n    new three.AmbientLight(0xbbbbbb), new three.DirectionalLight(0xffffff, 0.6), state.forceGraph]).hoverOrderComparator(function (a, b) {\n      // Prioritize graph objects\n      var aObj = getGraphObj(a);\n      if (!aObj) return 1;\n      var bObj = getGraphObj(b);\n      if (!bObj) return -1; // Prioritize nodes over links\n\n      var isNode = function isNode(o) {\n        return o.__graphObjType === 'node';\n      };\n\n      return isNode(bObj) - isNode(aObj);\n    }).tooltipContent(function (obj) {\n      var graphObj = getGraphObj(obj);\n      return graphObj ? accessorFn(state[\"\".concat(graphObj.__graphObjType, \"Label\")])(graphObj.__data) || '' : '';\n    }).hoverDuringDrag(false).onHover(function (obj) {\n      // Update tooltip and trigger onHover events\n      var hoverObj = getGraphObj(obj);\n\n      if (hoverObj !== state.hoverObj) {\n        var prevObjType = state.hoverObj ? state.hoverObj.__graphObjType : null;\n        var prevObjData = state.hoverObj ? state.hoverObj.__data : null;\n        var objType = hoverObj ? hoverObj.__graphObjType : null;\n        var objData = hoverObj ? hoverObj.__data : null;\n\n        if (prevObjType && prevObjType !== objType) {\n          // Hover out\n          state[\"on\".concat(prevObjType === 'node' ? 'Node' : 'Link', \"Hover\")](null, prevObjData);\n        }\n\n        if (objType) {\n          // Hover in\n          state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Hover\")](objData, prevObjType === objType ? prevObjData : null);\n        }\n\n        state.hoverObj = hoverObj;\n      }\n    }).clickAfterDrag(false).onClick(function (obj, ev) {\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"Click\")](graphObj.__data, ev);\n      } else {\n        state.onBackgroundClick(ev);\n      }\n    }).onRightClick(function (obj, ev) {\n      // Handle right-click events\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"RightClick\")](graphObj.__data, ev);\n      } else {\n        state.onBackgroundRightClick(ev);\n      }\n    }); //\n    // Kick-off renderer\n\n    this._animationCycle();\n  }\n}); //\n\n\nfunction getGraphObj(object) {\n  var obj = object; // recurse up object chain until finding the graph object\n\n  while (obj && !obj.hasOwnProperty('__graphObjType')) {\n    obj = obj.parent;\n  }\n\n  return obj;\n}\n\nexport default _3dForceGraph;","map":{"version":3,"sources":["/home/telix/dictographo/frontend/node_modules/3d-force-graph/dist/3d-force-graph.module.js"],"names":["AmbientLight","DirectionalLight","Vector3","DragControls","ThreeForceGraph","ThreeRenderObjects","accessorFn","Kapsule","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","css_248z","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","Symbol","iterator","from","o","minLen","n","prototype","toString","call","slice","constructor","name","test","len","arr2","TypeError","linkKapsule","kapsulePropName","kapsuleType","dummyK","linkProp","prop","onChange","v","state","triggerUpdate","linkMethod","method","kapsuleInstance","_len","args","_key","returnVal","three","window","THREE","CAMERA_DISTANCE2NODES_FACTOR","bindFG","linkedFGProps","assign","map","p","linkedFGMethods","bindRenderObjs","linkedRenderObjsProps","linkedRenderObjsMethods","concat","graph2ScreenCoords","_3dForceGraph","props","nodeLabel","linkLabel","linkHoverPrecision","renderObjs","lineHoverPrecision","enableNavigationControls","enable","controls","enabled","enableNodeDrag","onNodeDrag","_default","onNodeDragEnd","onNodeClick","onNodeRightClick","onNodeHover","onLinkClick","onLinkRightClick","onLinkHover","onBackgroundClick","onBackgroundRightClick","methods","zoomToFit","transitionDuration","padding","_state$forceGraph","bboxArgs","fitToBbox","forceGraph","getGraphBbox","pauseAnimation","animationFrameRequestId","cancelAnimationFrame","resumeAnimation","_animationCycle","enablePointerInteraction","renderer","domElement","cursor","tickFrame","tick","requestAnimationFrame","scene","camera","tbControls","_destructor","graphData","nodes","links","stateInit","_ref5","controlType","rendererConfig","init","domNode","innerHTML","container","position","roDomNode","lastSetCameraZ","z","infoElem","className","textContent","onLoading","onFinishLoading","onUpdate","x","y","lookAt","Math","cbrt","onFinishUpdate","_dragControls","curNodeDrag","find","node","__initialFixedPos","__disposeControlsAfterDrag","dispose","undefined","forceEngine","dragControls","__threeObj","addEventListener","event","__initialPos","clone","__prevPos","getGraphObj","__data","fx","fy","fz","c","classList","add","nodeObj","hasOwnProperty","initPos","prevPos","_newPos","sub","copy","newPos","translate","d3AlphaTarget","resetCountdown","__dragged","initFixedPos","fc","ownerDocument","dispatchEvent","PointerEvent","pointerType","remove","objects","hoverOrderComparator","a","b","aObj","bObj","isNode","__graphObjType","tooltipContent","graphObj","hoverDuringDrag","onHover","hoverObj","prevObjType","prevObjData","objType","objData","clickAfterDrag","onClick","ev","onRightClick","parent"],"mappings":"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","sourcesContent":["import { AmbientLight, DirectionalLight, Vector3 } from 'three';\nimport { DragControls } from 'three/examples/jsm/controls/DragControls.js';\nimport ThreeForceGraph from 'three-forcegraph';\nimport ThreeRenderObjects from 'three-render-objects';\nimport accessorFn from 'accessor-fn';\nimport Kapsule from 'kapsule';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".graph-info-msg {\\n  top: 50%;\\n  width: 100%;\\n  text-align: center;\\n  color: lavender;\\n  opacity: 0.7;\\n  font-size: 22px;\\n  position: absolute;\\n  font-family: Sans-serif;\\n}\\n\\n.grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\";\nstyleInject(css_248z);\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction linkKapsule (kapsulePropName, kapsuleType) {\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          state[kapsulePropName][prop](v);\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        var kapsuleInstance = state[kapsulePropName];\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n        return returnVal === kapsuleInstance ? this // chain based on the parent object, not the inner kapsule\n        : returnVal;\n      };\n    }\n  };\n}\n\nvar three = window.THREE ? window.THREE // Prefer consumption from global THREE, if exists\n: {\n  AmbientLight: AmbientLight,\n  DirectionalLight: DirectionalLight,\n  Vector3: Vector3\n};\n\nvar CAMERA_DISTANCE2NODES_FACTOR = 170; //\n// Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', ThreeForceGraph);\nvar linkedFGProps = Object.assign.apply(Object, _toConsumableArray(['jsonUrl', 'graphData', 'numDimensions', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'nodeRelSize', 'nodeId', 'nodeVal', 'nodeResolution', 'nodeColor', 'nodeAutoColorBy', 'nodeOpacity', 'nodeVisibility', 'nodeThreeObject', 'nodeThreeObjectExtend', 'linkSource', 'linkTarget', 'linkVisibility', 'linkColor', 'linkAutoColorBy', 'linkOpacity', 'linkWidth', 'linkResolution', 'linkCurvature', 'linkCurveRotation', 'linkMaterial', 'linkThreeObject', 'linkThreeObjectExtend', 'linkPositionUpdate', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalArrowResolution', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleResolution', 'forceEngine', 'd3AlphaDecay', 'd3VelocityDecay', 'd3AlphaMin', 'ngraphPhysics', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})));\nvar linkedFGMethods = Object.assign.apply(Object, _toConsumableArray(['refresh', 'getGraphBbox', 'd3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n}))); // Expose config from renderObjs\n\nvar bindRenderObjs = linkKapsule('renderObjs', ThreeRenderObjects);\nvar linkedRenderObjsProps = Object.assign.apply(Object, _toConsumableArray(['width', 'height', 'backgroundColor', 'showNavInfo', 'enablePointerInteraction'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkProp(p));\n})));\nvar linkedRenderObjsMethods = Object.assign.apply(Object, _toConsumableArray(['cameraPosition', 'postProcessingComposer'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkMethod(p));\n})).concat([{\n  graph2ScreenCoords: bindRenderObjs.linkMethod('getScreenCoords')\n}])); //\n\nvar _3dForceGraph = Kapsule({\n  props: _objectSpread2(_objectSpread2({\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 1,\n      onChange: function onChange(p, state) {\n        return state.renderObjs.lineHoverPrecision(p);\n      },\n      triggerUpdate: false\n    },\n    enableNavigationControls: {\n      \"default\": true,\n      onChange: function onChange(enable, state) {\n        var controls = state.renderObjs.controls();\n\n        if (controls) {\n          controls.enabled = enable;\n        }\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    }\n  }, linkedFGProps), linkedRenderObjsProps),\n  methods: _objectSpread2(_objectSpread2({\n    zoomToFit: function zoomToFit(state, transitionDuration, padding) {\n      var _state$forceGraph;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      state.renderObjs.fitToBbox((_state$forceGraph = state.forceGraph).getGraphBbox.apply(_state$forceGraph, bboxArgs), transitionDuration, padding);\n      return this;\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId !== null) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (state.animationFrameRequestId === null) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _animationCycle: function _animationCycle(state) {\n      if (state.enablePointerInteraction) {\n        // reset canvas cursor (override dragControls cursor)\n        this.renderer().domElement.style.cursor = null;\n      } // Frame cycle\n\n\n      state.forceGraph.tickFrame();\n      state.renderObjs.tick();\n      state.animationFrameRequestId = requestAnimationFrame(this._animationCycle);\n    },\n    scene: function scene(state) {\n      return state.renderObjs.scene();\n    },\n    // Expose scene\n    camera: function camera(state) {\n      return state.renderObjs.camera();\n    },\n    // Expose camera\n    renderer: function renderer(state) {\n      return state.renderObjs.renderer();\n    },\n    // Expose renderer\n    controls: function controls(state) {\n      return state.renderObjs.controls();\n    },\n    // Expose controls\n    tbControls: function tbControls(state) {\n      return state.renderObjs.tbControls();\n    },\n    // To be deprecated\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedFGMethods), linkedRenderObjsMethods),\n  stateInit: function stateInit(_ref5) {\n    var controlType = _ref5.controlType,\n        rendererConfig = _ref5.rendererConfig;\n    return {\n      forceGraph: new ThreeForceGraph(),\n      renderObjs: ThreeRenderObjects({\n        controlType: controlType,\n        rendererConfig: rendererConfig\n      })\n    };\n  },\n  init: function init(domNode, state) {\n    // Wipe DOM\n    domNode.innerHTML = ''; // Add relative container\n\n    domNode.appendChild(state.container = document.createElement('div'));\n    state.container.style.position = 'relative'; // Add renderObjs\n\n    var roDomNode = document.createElement('div');\n    state.container.appendChild(roDomNode);\n    state.renderObjs(roDomNode);\n    var camera = state.renderObjs.camera();\n    var renderer = state.renderObjs.renderer();\n    var controls = state.renderObjs.controls();\n    controls.enabled = !!state.enableNavigationControls;\n    state.lastSetCameraZ = camera.position.z; // Add info space\n\n    var infoElem;\n    state.container.appendChild(infoElem = document.createElement('div'));\n    infoElem.className = 'graph-info-msg';\n    infoElem.textContent = ''; // config forcegraph\n\n    state.forceGraph.onLoading(function () {\n      infoElem.textContent = 'Loading...';\n    }).onFinishLoading(function () {\n      infoElem.textContent = '';\n    }).onUpdate(function () {\n      // sync graph data structures\n      state.graphData = state.forceGraph.graphData(); // re-aim camera, if still in default position (not user modified)\n\n      if (camera.position.x === 0 && camera.position.y === 0 && camera.position.z === state.lastSetCameraZ && state.graphData.nodes.length) {\n        camera.lookAt(state.forceGraph.position);\n        state.lastSetCameraZ = camera.position.z = Math.cbrt(state.graphData.nodes.length) * CAMERA_DISTANCE2NODES_FACTOR;\n      }\n    }).onFinishUpdate(function () {\n      // Setup node drag interaction\n      if (state._dragControls) {\n        var curNodeDrag = state.graphData.nodes.find(function (node) {\n          return node.__initialFixedPos && !node.__disposeControlsAfterDrag;\n        }); // detect if there's a node being dragged using the existing drag controls\n\n        if (curNodeDrag) {\n          curNodeDrag.__disposeControlsAfterDrag = true; // postpone previous controls disposal until drag ends\n        } else {\n          state._dragControls.dispose(); // cancel previous drag controls\n\n        }\n\n        state._dragControls = undefined;\n      }\n\n      if (state.enableNodeDrag && state.enablePointerInteraction && state.forceEngine === 'd3') {\n        // Can't access node positions programatically in ngraph\n        var dragControls = state._dragControls = new DragControls(state.graphData.nodes.map(function (node) {\n          return node.__threeObj;\n        }).filter(function (obj) {\n          return obj;\n        }), camera, renderer.domElement);\n        dragControls.addEventListener('dragstart', function (event) {\n          controls.enabled = false; // Disable controls while dragging\n          // track drag object movement\n\n          event.object.__initialPos = event.object.position.clone();\n          event.object.__prevPos = event.object.position.clone();\n\n          var node = getGraphObj(event.object).__data;\n\n          !node.__initialFixedPos && (node.__initialFixedPos = {\n            fx: node.fx,\n            fy: node.fy,\n            fz: node.fz\n          });\n          !node.__initialPos && (node.__initialPos = {\n            x: node.x,\n            y: node.y,\n            z: node.z\n          }); // lock node\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c];\n          }); // drag cursor\n\n          renderer.domElement.classList.add('grabbable');\n        });\n        dragControls.addEventListener('drag', function (event) {\n          var nodeObj = getGraphObj(event.object);\n\n          if (!event.object.hasOwnProperty('__graphObjType')) {\n            // If dragging a child of the node, update the node object instead\n            var initPos = event.object.__initialPos;\n            var prevPos = event.object.__prevPos;\n            var _newPos = event.object.position;\n            nodeObj.position.add(_newPos.clone().sub(prevPos)); // translate node object by the motion delta\n\n            prevPos.copy(_newPos);\n\n            _newPos.copy(initPos); // reset child back to its initial position\n\n          }\n\n          var node = nodeObj.__data;\n          var newPos = nodeObj.position;\n          var translate = {\n            x: newPos.x - node.x,\n            y: newPos.y - node.y,\n            z: newPos.z - node.z\n          }; // Move fx/fy/fz (and x/y/z) of nodes based on object new position\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c] = newPos[c];\n          });\n          state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n          .resetCountdown(); // prevent freeze while dragging\n\n          node.__dragged = true;\n          state.onNodeDrag(node, translate);\n        });\n        dragControls.addEventListener('dragend', function (event) {\n          delete event.object.__initialPos; // remove tracking attributes\n\n          delete event.object.__prevPos;\n\n          var node = getGraphObj(event.object).__data; // dispose previous controls if needed\n\n\n          if (node.__disposeControlsAfterDrag) {\n            dragControls.dispose();\n            delete node.__disposeControlsAfterDrag;\n          }\n\n          var initFixedPos = node.__initialFixedPos;\n          var initPos = node.__initialPos;\n          var translate = {\n            x: initPos.x - node.x,\n            y: initPos.y - node.y,\n            z: initPos.z - node.z\n          };\n\n          if (initFixedPos) {\n            ['x', 'y', 'z'].forEach(function (c) {\n              var fc = \"f\".concat(c);\n\n              if (initFixedPos[fc] === undefined) {\n                delete node[fc];\n              }\n            });\n            delete node.__initialFixedPos;\n            delete node.__initialPos;\n\n            if (node.__dragged) {\n              delete node.__dragged;\n              state.onNodeDragEnd(node, translate);\n            }\n          }\n\n          state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n          .resetCountdown(); // let the engine readjust after releasing fixed nodes\n\n          if (state.enableNavigationControls) {\n            controls.enabled = true; // Re-enable controls\n\n            controls.domElement && controls.domElement.ownerDocument && controls.domElement.ownerDocument.dispatchEvent( // simulate mouseup to ensure the controls don't take over after dragend\n            new PointerEvent('pointerup', {\n              pointerType: 'mouse'\n            }));\n          } // clear cursor\n\n\n          renderer.domElement.classList.remove('grabbable');\n        });\n      }\n    }); // config renderObjs\n\n    state.renderObjs.objects([// Populate scene\n    new three.AmbientLight(0xbbbbbb), new three.DirectionalLight(0xffffff, 0.6), state.forceGraph]).hoverOrderComparator(function (a, b) {\n      // Prioritize graph objects\n      var aObj = getGraphObj(a);\n      if (!aObj) return 1;\n      var bObj = getGraphObj(b);\n      if (!bObj) return -1; // Prioritize nodes over links\n\n      var isNode = function isNode(o) {\n        return o.__graphObjType === 'node';\n      };\n\n      return isNode(bObj) - isNode(aObj);\n    }).tooltipContent(function (obj) {\n      var graphObj = getGraphObj(obj);\n      return graphObj ? accessorFn(state[\"\".concat(graphObj.__graphObjType, \"Label\")])(graphObj.__data) || '' : '';\n    }).hoverDuringDrag(false).onHover(function (obj) {\n      // Update tooltip and trigger onHover events\n      var hoverObj = getGraphObj(obj);\n\n      if (hoverObj !== state.hoverObj) {\n        var prevObjType = state.hoverObj ? state.hoverObj.__graphObjType : null;\n        var prevObjData = state.hoverObj ? state.hoverObj.__data : null;\n        var objType = hoverObj ? hoverObj.__graphObjType : null;\n        var objData = hoverObj ? hoverObj.__data : null;\n\n        if (prevObjType && prevObjType !== objType) {\n          // Hover out\n          state[\"on\".concat(prevObjType === 'node' ? 'Node' : 'Link', \"Hover\")](null, prevObjData);\n        }\n\n        if (objType) {\n          // Hover in\n          state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Hover\")](objData, prevObjType === objType ? prevObjData : null);\n        }\n\n        state.hoverObj = hoverObj;\n      }\n    }).clickAfterDrag(false).onClick(function (obj, ev) {\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"Click\")](graphObj.__data, ev);\n      } else {\n        state.onBackgroundClick(ev);\n      }\n    }).onRightClick(function (obj, ev) {\n      // Handle right-click events\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"RightClick\")](graphObj.__data, ev);\n      } else {\n        state.onBackgroundRightClick(ev);\n      }\n    }); //\n    // Kick-off renderer\n\n    this._animationCycle();\n  }\n}); //\n\nfunction getGraphObj(object) {\n  var obj = object; // recurse up object chain until finding the graph object\n\n  while (obj && !obj.hasOwnProperty('__graphObjType')) {\n    obj = obj.parent;\n  }\n\n  return obj;\n}\n\nexport default _3dForceGraph;\n"]},"metadata":{},"sourceType":"module"}