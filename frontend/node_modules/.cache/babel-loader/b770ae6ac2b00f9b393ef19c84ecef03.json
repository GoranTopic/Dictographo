{"ast":null,"code":"import Octant from \"./octant\";\nexport default function (x, y, z, radius) {\n  var data,\n      x0 = this._x0,\n      y0 = this._y0,\n      z0 = this._z0,\n      x1,\n      y1,\n      z1,\n      x2,\n      y2,\n      z2,\n      x3 = this._x1,\n      y3 = this._y1,\n      z3 = this._z1,\n      octs = [],\n      node = this._root,\n      q,\n      i;\n  if (node) octs.push(new Octant(node, x0, y0, z0, x3, y3, z3));\n  if (radius == null) radius = Infinity;else {\n    x0 = x - radius, y0 = y - radius, z0 = z - radius;\n    x3 = x + radius, y3 = y + radius, z3 = z + radius;\n    radius *= radius;\n  }\n\n  while (q = octs.pop()) {\n    // Stop searching if this octant can’t contain a closer node.\n    if (!(node = q.node) || (x1 = q.x0) > x3 || (y1 = q.y0) > y3 || (z1 = q.z0) > z3 || (x2 = q.x1) < x0 || (y2 = q.y1) < y0 || (z2 = q.z1) < z0) continue; // Bisect the current octant.\n\n    if (node.length) {\n      var xm = (x1 + x2) / 2,\n          ym = (y1 + y2) / 2,\n          zm = (z1 + z2) / 2;\n      octs.push(new Octant(node[7], xm, ym, zm, x2, y2, z2), new Octant(node[6], x1, ym, zm, xm, y2, z2), new Octant(node[5], xm, y1, zm, x2, ym, z2), new Octant(node[4], x1, y1, zm, xm, ym, z2), new Octant(node[3], xm, ym, z1, x2, y2, zm), new Octant(node[2], x1, ym, z1, xm, y2, zm), new Octant(node[1], xm, y1, z1, x2, ym, zm), new Octant(node[0], x1, y1, z1, xm, ym, zm)); // Visit the closest octant first.\n\n      if (i = (z >= zm) << 2 | (y >= ym) << 1 | x >= xm) {\n        q = octs[octs.length - 1];\n        octs[octs.length - 1] = octs[octs.length - 1 - i];\n        octs[octs.length - 1 - i] = q;\n      }\n    } // Visit this point. (Visiting coincident points isn’t necessary!)\n    else {\n        var dx = x - +this._x.call(null, node.data),\n            dy = y - +this._y.call(null, node.data),\n            dz = z - +this._z.call(null, node.data),\n            d2 = dx * dx + dy * dy + dz * dz;\n\n        if (d2 < radius) {\n          var d = Math.sqrt(radius = d2);\n          x0 = x - d, y0 = y - d, z0 = z - d;\n          x3 = x + d, y3 = y + d, z3 = z + d;\n          data = node.data;\n        }\n      }\n  }\n\n  return data;\n}","map":{"version":3,"sources":["/home/telix/dictographo/frontend/node_modules/d3-octree/src/find.js"],"names":["Octant","x","y","z","radius","data","x0","_x0","y0","_y0","z0","_z0","x1","y1","z1","x2","y2","z2","x3","_x1","y3","_y1","z3","_z1","octs","node","_root","q","i","push","Infinity","pop","length","xm","ym","zm","dx","_x","call","dy","_y","dz","_z","d2","d","Math","sqrt"],"mappings":"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","sourcesContent":["import Octant from \"./octant\";\n\nexport default function(x, y, z, radius) {\n  var data,\n      x0 = this._x0,\n      y0 = this._y0,\n      z0 = this._z0,\n      x1,\n      y1,\n      z1,\n      x2,\n      y2,\n      z2,\n      x3 = this._x1,\n      y3 = this._y1,\n      z3 = this._z1,\n      octs = [],\n      node = this._root,\n      q,\n      i;\n\n  if (node) octs.push(new Octant(node, x0, y0, z0, x3, y3, z3));\n  if (radius == null) radius = Infinity;\n  else {\n    x0 = x - radius, y0 = y - radius, z0 = z - radius;\n    x3 = x + radius, y3 = y + radius, z3 = z + radius;\n    radius *= radius;\n  }\n\n  while (q = octs.pop()) {\n\n    // Stop searching if this octant can’t contain a closer node.\n    if (!(node = q.node)\n        || (x1 = q.x0) > x3\n        || (y1 = q.y0) > y3\n        || (z1 = q.z0) > z3\n        || (x2 = q.x1) < x0\n        || (y2 = q.y1) < y0\n        || (z2 = q.z1) < z0) continue;\n\n    // Bisect the current octant.\n    if (node.length) {\n      var xm = (x1 + x2) / 2,\n          ym = (y1 + y2) / 2,\n          zm = (z1 + z2) / 2;\n\n      octs.push(\n        new Octant(node[7], xm, ym, zm, x2, y2, z2),\n        new Octant(node[6], x1, ym, zm, xm, y2, z2),\n        new Octant(node[5], xm, y1, zm, x2, ym, z2),\n        new Octant(node[4], x1, y1, zm, xm, ym, z2),\n        new Octant(node[3], xm, ym, z1, x2, y2, zm),\n        new Octant(node[2], x1, ym, z1, xm, y2, zm),\n        new Octant(node[1], xm, y1, z1, x2, ym, zm),\n        new Octant(node[0], x1, y1, z1, xm, ym, zm)\n      );\n\n      // Visit the closest octant first.\n      if (i = (z >= zm) << 2 | (y >= ym) << 1 | (x >= xm)) {\n        q = octs[octs.length - 1];\n        octs[octs.length - 1] = octs[octs.length - 1 - i];\n        octs[octs.length - 1 - i] = q;\n      }\n    }\n\n    // Visit this point. (Visiting coincident points isn’t necessary!)\n    else {\n      var dx = x - +this._x.call(null, node.data),\n          dy = y - +this._y.call(null, node.data),\n          dz = z - +this._z.call(null, node.data),\n          d2 = dx * dx + dy * dy + dz * dz;\n      if (d2 < radius) {\n        var d = Math.sqrt(radius = d2);\n        x0 = x - d, y0 = y - d, z0 = z - d;\n        x3 = x + d, y3 = y + d, z3 = z + d;\n        data = node.data;\n      }\n    }\n  }\n\n  return data;\n}\n"]},"metadata":{},"sourceType":"module"}