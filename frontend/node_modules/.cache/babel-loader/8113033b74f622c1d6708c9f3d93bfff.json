{"ast":null,"code":"var _jsxFileName = \"/home/telix/dictographo/frontend/src/Components/Graph/Graph.js\";\nimport React, { useState, useEffect, useLayoutEffect } from 'react';\nimport { Graph } from \"react-d3-graph\";\nimport { onClickNode } from '../../node_functions';\nimport { graphConfig } from \"../../myConfig\"; //import d3Switcher from \"./d3Switcher\";\n\nimport ForceGraph2D from 'react-force-graph-2d';\nimport ForceGraph3D from 'react-force-graph-3d'; //import ForceGraphVR from 'react-force-graph-vr';\n//import ForceGraphAR from 'react-force-graph-ar';\n\n/*\n * =======================================\n *      Graph Componente for React \n * =======================================\n */\n\nfunction GraphContainer({\n  state,\n  dispatchState\n}) {\n  const {\n    //useState,\n    //useEffect, \n    useCallback\n  } = React; // if graph is d3 and previous graph is not d3, the it is switching to d3\n\n  const isSwitchingTo3d = state.graphType === 'd3' && state.prevGraphType !== 'd3';\n\n  const changeState = () => dispatchState({\n    type: 'CHANGE_D3_STATE'\n  });\n\n  useLayoutEffect(() => {\n    console.log(\"use layout effect\"); //isSwitchingTo3d && setD3State({...state, links:[] })\n\n    isSwitchingTo3d && changeState();\n  }, [isSwitchingTo3d, changeState]);\n\n  const changeLinkIdToString = state => {\n    let d3State = { ...state\n    };\n    d3State.links = [...state.links]; // make copy of array\n\n    return state;\n\n    for (let i = 0; i < state.links.length; i++) {\n      console.log(state.links);\n      d3State.links[i] = [...state.links][i]; // make copy of link object\n\n      if (!d3State.links[i].source instanceof String) {\n        d3State.links[i].source = state.links[i].source.id;\n        d3State.links[i].target = state.links[i].target.id;\n      }\n    }\n\n    console.log(d3State);\n    console.log(\"changed the state\");\n    return d3State;\n  };\n\n  useEffect(() => {\n    console.log('isSwitching: ' + isSwitchingTo3d); //isSwitchingTo3d && setD3State(state)\n\n    if (isSwitchingTo3d) {\n      state.links.forEach(link => {\n        //setD3State({...state, links: [ ...state.links, {source: link.source.id, target: link.target.id} ]})\n        console.log(\"settin link:\");\n        console.log(link);\n      });\n      console.log(\"set state\");\n    }\n\n    return () => {\n      console.log(\"clean up ran\");\n    };\n  }, [isSwitchingTo3d, state]);\n  const handleClick = useCallback( // handle click of node\n  nodeId => onClickNode(nodeId, state, dispatchState), [state, dispatchState]);\n\n  const chosenGraph = type => {\n    switch (type) {\n      case 'd3':\n        //console.log(state)\n        if (isSwitchingTo3d) {\n          //console.log(\"checking the state\")\n          //console.log(state)\n          //console.log({...state, links:[]})\n          return /*#__PURE__*/React.createElement(Graph, {\n            id: \"graph-id\" // id is mandatory, \n            // if no id is defined rd3g will throw an error\n            ,\n            data: changeLinkIdToString(state),\n            config: graphConfig,\n            onClickNode: handleClick,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 18\n            }\n          });\n        } else {\n          //console.log(\"checking the state\")\n          console.log(state); //console.log({...state, links:[]})\n\n          return /*#__PURE__*/React.createElement(Graph, {\n            id: \"graph-id\" // id is mandatory, \n            // if no id is defined rd3g will throw an error\n            ,\n            data: changeLinkIdToString(state),\n            config: graphConfig,\n            onClickNode: handleClick,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 18\n            }\n          });\n        }\n\n      case '2D':\n        //console.log(state)\n        return /*#__PURE__*/React.createElement(ForceGraph2D, {\n          enableNodeDrag: true,\n          onNodeClick: handleClick,\n          graphData: { ...state\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 16\n          }\n        });\n\n      case '3D':\n        //console.log(state)\n        return /*#__PURE__*/React.createElement(ForceGraph3D, {\n          enableNodeDrag: true,\n          onNodeClick: handleClick,\n          graphData: { ...state\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 16\n          }\n        });\n\n      default:\n        //console.log(state)\n        return /*#__PURE__*/React.createElement(Graph, {\n          id: \"graph-id\" // id is mandatory, \n          // if no id is defined rd3g will throw an error\n          ,\n          data: state,\n          config: graphConfig,\n          onClickNode: handleClick,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 16\n          }\n        });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      backgroundImage: 'url(./grid.png)'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 10\n    }\n  }, chosenGraph(state.graphType));\n}\n\nexport default GraphContainer;","map":{"version":3,"sources":["/home/telix/dictographo/frontend/src/Components/Graph/Graph.js"],"names":["React","useState","useEffect","useLayoutEffect","Graph","onClickNode","graphConfig","ForceGraph2D","ForceGraph3D","GraphContainer","state","dispatchState","useCallback","isSwitchingTo3d","graphType","prevGraphType","changeState","type","console","log","changeLinkIdToString","d3State","links","i","length","source","String","id","target","forEach","link","handleClick","nodeId","chosenGraph","backgroundImage"],"mappings":"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","sourcesContent":["import React, { useState,  useEffect, useLayoutEffect }  from 'react';\nimport { Graph } from \"react-d3-graph\";\nimport { onClickNode } from '../../node_functions';\nimport { graphConfig }  from \"../../myConfig\";\n//import d3Switcher from \"./d3Switcher\";\nimport ForceGraph2D from 'react-force-graph-2d';\nimport ForceGraph3D from 'react-force-graph-3d';\n//import ForceGraphVR from 'react-force-graph-vr';\n//import ForceGraphAR from 'react-force-graph-ar';\n\n/*\n * =======================================\n *      Graph Componente for React \n * =======================================\n */\n\nfunction GraphContainer({state, dispatchState}){\n\n\t\tconst { \n\t\t\t\t//useState,\n\t\t\t\t//useEffect, \n\t\t\t\tuseCallback\n\t\t} = React;\n\n\t\t// if graph is d3 and previous graph is not d3, the it is switching to d3\n\t\tconst isSwitchingTo3d = (state.graphType === 'd3' && state.prevGraphType !== 'd3')\n\t\tconst changeState = () => dispatchState({type:'CHANGE_D3_STATE'})\n\n\t\tuseLayoutEffect(() => {\n\t\t\t\tconsole.log(\"use layout effect\")\n\t\t\t\t//isSwitchingTo3d && setD3State({...state, links:[] })\n\t\t\t\tisSwitchingTo3d && changeState()\n\t\t}, [isSwitchingTo3d, changeState])\n\n\t\t\n\t\tconst changeLinkIdToString = (state) => {\n\t\t\t\tlet d3State = {...state};\n\t\t\t\td3State.links = [...state.links]; // make copy of array\n\t\t\t\treturn state;\n\t\t\t\tfor(let i = 0; i < state.links.length; i++ ){\n\t\t\t\t\t\tconsole.log(state.links)\n\t\t\t\t\t\td3State.links[i] = [...state.links][i]; // make copy of link object\n\n\t\t\t\t\t\tif(!d3State.links[i].source instanceof String){\n\t\t\t\t\t\t\td3State.links[i].source = state.links[i].source.id\n\t\t\t\t\t\t\td3State.links[i].target = state.links[i].target.id\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconsole.log(d3State)\n\t\t\t\tconsole.log(\"changed the state\")\n\t\t\t\treturn d3State;\n\t\t}\n\n\t\tuseEffect(() => {  \n\t\t\t\tconsole.log('isSwitching: ' + isSwitchingTo3d);\n\t\t\t\t//isSwitchingTo3d && setD3State(state)\n\t\t\t\tif(isSwitchingTo3d){\n\t\t\t\t\t\tstate.links.forEach((link) => { \n\t\t\t\t\t\t\t\t//setD3State({...state, links: [ ...state.links, {source: link.source.id, target: link.target.id} ]})\n\t\t\t\t\t\t\t\tconsole.log(\"settin link:\")\n\t\t\t\t\t\t\t\tconsole.log(link)\n\n\t\t\t\t\t\t})\n\t\t\t\t\t\tconsole.log(\"set state\")\n\t\t\t\t}\n\n\t\t\t\treturn () => {\n\t\t\t\t\t\tconsole.log(\"clean up ran\")\n\t\t\t\t\t\t\t \n\t\t\t\t}\n\t\t\t}, [isSwitchingTo3d, state])\n\n\t\t\t\n\t\tconst handleClick = useCallback( // handle click of node\n\t\t\t\t(nodeId) => onClickNode(nodeId, state, dispatchState), \n\t\t\t\t[state, dispatchState]);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\n\t\tconst chosenGraph = (type) =>{ \n\t\t\t\tswitch(type) {\n\t\t\t\t\t\tcase 'd3':\n\t\t\t\t\t\t\t\t//console.log(state)\n\t\t\t\t\t\t\t\tif(isSwitchingTo3d){\n\t\t\t\t\t\t\t\t\t\t//console.log(\"checking the state\")\n\t\t\t\t\t\t\t\t\t\t//console.log(state)\n\t\t\t\t\t\t\t\t\t\t//console.log({...state, links:[]})\n\t\t\t\t\t\t\t\t\t\treturn <Graph \n\t\t\t\t\t\t\t\t\t\t\t\tid=\"graph-id\" \n\t\t\t\t\t\t\t\t\t\t\t\t// id is mandatory, \n\t\t\t\t\t\t\t\t\t\t\t\t// if no id is defined rd3g will throw an error\n\t\t\t\t\t\t\t\t\t\t\t\tdata={changeLinkIdToString(state)}\n\t\t\t\t\t\t\t\t\t\t\t\tconfig={graphConfig}\n\t\t\t\t\t\t\t\t\t\t\t\tonClickNode={handleClick}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t//console.log(\"checking the state\")\n\t\t\t\t\t\t\t\t\t\tconsole.log(state)\n\t\t\t\t\t\t\t\t\t\t//console.log({...state, links:[]})\n\t\t\t\t\t\t\t\t\t\treturn <Graph \n\t\t\t\t\t\t\t\t\t\t\t\tid=\"graph-id\" \n\t\t\t\t\t\t\t\t\t\t\t\t// id is mandatory, \n\t\t\t\t\t\t\t\t\t\t\t\t// if no id is defined rd3g will throw an error\n\t\t\t\t\t\t\t\t\t\t\t\tdata={changeLinkIdToString(state)}\n\n\n\t\t\t\t\t\t\t\t\t\t\t\tconfig={graphConfig}\n\t\t\t\t\t\t\t\t\t\t\t\tonClickNode={handleClick}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcase '2D':\n\t\t\t\t\t\t\t\t//console.log(state)\n\t\t\t\t\t\t\t\treturn <ForceGraph2D\n\t\t\t\t\t\t\t\t\t\tenableNodeDrag={true}\n\t\t\t\t\t\t\t\t\t\tonNodeClick={handleClick}\n\t\t\t\t\t\t\t\t\t\tgraphData={{...state}}\n\t\t\t\t\t\t\t\t/>;\n\t\t\t\t\t\tcase '3D':\n\t\t\t\t\t\t\t\t//console.log(state)\n\t\t\t\t\t\t\t\treturn <ForceGraph3D\n\t\t\t\t\t\t\t\t\t\tenableNodeDrag={true}\n\t\t\t\t\t\t\t\t\t\tonNodeClick={handleClick}\n\t\t\t\t\t\t\t\t\t\tgraphData={{...state}}\n\t\t\t\t\t\t\t\t/>;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t//console.log(state)\n\t\t\t\t\t\t\t\treturn <Graph \n\t\t\t\t\t\t\t\t\t\tid=\"graph-id\" \n\t\t\t\t\t\t\t\t\t\t// id is mandatory, \n\t\t\t\t\t\t\t\t\t\t// if no id is defined rd3g will throw an error\n\t\t\t\t\t\t\t\t\t\tdata={state}\n\t\t\t\t\t\t\t\t\t\tconfig={graphConfig}\n\t\t\t\t\t\t\t\t\t\tonClickNode={handleClick}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t} \n\t\t}\n\n\n\t\treturn <div style={{backgroundImage: 'url(./grid.png)'}} >\n\t\t\t\t{chosenGraph(state.graphType)}\n\t\t</div>\n\t\t\n}\n\nexport default GraphContainer;\n"]},"metadata":{},"sourceType":"module"}